---
title: "HW2"
author: "juan"
date: '2017-09-26'
output: github_document
---
# Welcome to Juan's Homework 2

In this first part of the assignment, we will see the **data type** of the gapminder package and variables as well as the **structure**, **names** and **summaries**. 
```{r}
library(gapminder)
suppressMessages(library(tidyverse))

str(gapminder)
names(gapminder)
length(gapminder)
summary(gapminder)
summary(gapminder$gdpPercap)
typeof(gapminder)
typeof(gapminder$year)
typeof(gapminder$lifeExp)

a<- filter(gapminder, continent == "Americas")
select(filter(a, country== "Colombia"), country, gdpPercap, lifeExp, year) 
```
## The life Expectancy looks to be near 75
```{r figure2.1}
hist(gapminder$lifeExp, col="green")
```

####In this second part of the assignment, I'm going to show the increment of population, life expectancy and gdpper capita in Colombia and other contries in the Americas since the year I was born (1987). This is to prove my theory that I brought good things to the world.
Here we have Colombia's Life Expectancy, gdpPercapita and Population digits since 1987 to 2004. As we can see in the graph below there was a hiccoup in the economy in 2002 follow by an significant recovery.
```{r figure2}
my_colombia<- a %>% 
  filter(country== "Colombia", year >= 1987) %>%
  select(country, year, lifeExp, gdpPercap, pop)
my_colombia
```
```{r figure2.2, echo=FALSE}
ggplot(my_colombia, aes(x=year, y=gdpPercap))+ geom_path()+
  geom_bar(stat="identity", color="green", fill="steelblue")
```

##  Now let's look at the growing life expectancy variable. Here are the increment numbers and **the function that I wrote** to see the results:
```{r}
inc<- function(x,y) {z<- x - y}
mutate(my_colombia, inc_lifeExp= inc(lifeExp, lifeExp[+1]), inc_gdpPercap= inc(gdpPercap, gdpPercap[+1]))
```

## Now, let's see the population vs gdpPercap 
```{r figure2.3}
my_colombia %>%
  arrange(year) %>% 
  ggplot(aes(pop, gdpPercap)) +
  geom_point(color= "red") +
  geom_path(color= "blue")
```

## But enough about Colombia, let's see how other countries in the Americas have done since I came to earth:
```{r figure2.4}
a %>%
  group_by(country) %>% 
  ggplot(aes(year, gdpPercap)) + geom_smooth()+
  geom_point(aes(color= country, size= pop ))
```

#### So, we can conclude that most countries have seen some improvemnts in gdpPercapita and an increase in population. (Also, that I haven't learnt how to read the graphs and I specualte a lot, I'm working on that)

